"use strict";(self.webpackChunkdoctor_appointment_booking=self.webpackChunkdoctor_appointment_booking||[]).push([[299],{299:(e,i,l)=>{l.r(i),l.d(i,{default:()=>B});var n=l(5043),o=l(3519),d=l(4816),t=l(1428),s=l(8628),a=l(3401),c=l(4282),r=l(1072),v=l(8602),u=l(4063),m=l(633),h=l(1785),g=l(6867),x=l(579);const j=function(e){let{open:i,type:l,title:o,body:d,loading:t=!1,disable:s=!1,confirmButton:a,onConfirm:r,closeButton:v,onClose:u,children:m}=e;const[j,p]=(0,n.useState)(i),b=()=>{u&&u(!1)};return(0,n.useEffect)((()=>{p(i)}),[i]),(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(h.A,{show:j,onHide:b,backdrop:"static",keyboard:!1,children:[(0,x.jsx)(h.A.Header,{closeButton:!0,children:(0,x.jsx)(h.A.Title,{children:o})}),(0,x.jsx)(h.A.Body,{children:d||m}),(0,x.jsxs)(h.A.Footer,{children:[(0,x.jsx)(c.A,{variant:"secondary",onClick:b,children:null!==v&&void 0!==v?v:"Close"}),(0,x.jsx)(c.A,{variant:l||"primary",disabled:s,onClick:()=>{p(!1),r&&r(!1)},children:(0,x.jsx)(g.A,{loading:t,children:a})})]})]})})};var p=l(4749),b=l(1089),k=l(2327),A=l(6522),y=l(1719);const f=e=>{let{slot:i}=e;return(0,x.jsxs)(k.A,{direction:"horizontal",gap:2,children:[(0,x.jsx)(u.A,{bg:"secondary",children:(0,b.fU)(null===i||void 0===i?void 0:i.start_time)}),(0,x.jsx)("span",{children:" - "}),(0,x.jsx)(u.A,{bg:"secondary",children:(0,b.fU)(null===i||void 0===i?void 0:i.end_time)})]})},C=e=>{var i,l;let{booking:o}=e;const[d,t]=(0,n.useState)(!0),[s,a]=(0,n.useState)({valid:!0}),[u,m]=(0,n.useState)({booking_id:null===o||void 0===o?void 0:o.booking_id,date:null===o||void 0===o?void 0:o.date,slot_id:null===o||void 0===o||null===(i=o.slot)||void 0===i?void 0:i.slot_id}),{data:j,isLoading:b,isFetching:k}=(0,p.eI)({date:null===u||void 0===u?void 0:u.date}),[C,N]=(0,p.JB)();(0,n.useEffect)((()=>{if(Array.isArray(j)&&null!==j&&void 0!==j&&j.length){const e=j.find((e=>{var i;return(null===e||void 0===e?void 0:e.slot_id)===(null===o||void 0===o||null===(i=o.slot)||void 0===i?void 0:i.slot_id)}));m({...u,slot_id:null===e||void 0===e?void 0:e.slot_id})}else m({...u,slot_id:null})}),[j,null===o||void 0===o||null===(l=o.slot)||void 0===l?void 0:l.slot_id,u]);const _=(e,i)=>{var l;let n={...u};n=null!==i&&void 0!==i&&null!==(l=i.target)&&void 0!==l&&l.value?{...u,[e]:i.target.value}:e&&i?{...u,[e]:i}:{...u,...e},m(n),w(n)},w=e=>{let{...i}=e,l=!0;if(a({valid:l}),null!==i&&void 0!==i&&i.date){const e=new Date;new Date(null===i||void 0===i?void 0:i.date)>=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),0,0,0)||(l=!1,a({...s,valid:l,date:"Please select valid date"}))}else l=!1,a({...s,valid:l,date:"Please select booking date"});return null===j||void 0===j||!j.length||null!==i&&void 0!==i&&i.slot_id||(l=!1,a({...s,valid:l,slot:"Please select booking slot"})),l};return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(h.A,{show:d,onHide:()=>t(!1),backdrop:"static",keyboard:!1,children:[(0,x.jsx)(h.A.Header,{closeButton:!0,children:(0,x.jsx)(h.A.Title,{children:"Reschedule Booking"})}),(0,x.jsx)(h.A.Body,{children:(0,x.jsxs)(A.A,{noValidate:!0,validated:s.valid,children:[(0,x.jsx)(A.A.Control,{type:"date",value:null===u||void 0===u?void 0:u.date,onChange:e=>_("date",e),isInvalid:!(null===s||void 0===s||!s.date)}),(null===s||void 0===s?void 0:s.date)&&(0,x.jsx)(A.A.Control.Feedback,{type:"invalid",children:s.date}),b||k?(0,x.jsx)(g.A,{loading:b||k,children:" "}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(r.A,{className:"mt-3",children:(0,x.jsx)(v.A,{xs:12,children:(0,x.jsx)(A.A.Label,{className:"text-capitalize",children:null!==j&&void 0!==j&&j.length?null===j||void 0===j?void 0:j[0].day:(0,x.jsx)(y.A,{variant:"warning",children:"No availability slot found. Set slot from Availability option."},"warning")})})}),(j||[]).map((e=>(0,x.jsx)(r.A,{children:(0,x.jsx)(v.A,{xs:12,children:(0,x.jsx)(A.A.Check,{disabled:!1,checked:(null===u||void 0===u?void 0:u.slot_id)===(null===e||void 0===e?void 0:e.slot_id),type:"radio",onChange:()=>_("slot_id",null===e||void 0===e?void 0:e.slot_id),label:(0,x.jsx)(f,{slot:e}),id:null===e||void 0===e?void 0:e.slot_id,isInvalid:!0})})}))),(null===s||void 0===s?void 0:s.slot)&&(0,x.jsx)("span",{className:"text-danger",style:{fontSize:".87rem"},children:s.slot})]})]})}),(0,x.jsxs)(h.A.Footer,{children:[(0,x.jsx)(c.A,{variant:"secondary",onClick:()=>t(!1),children:"Close"}),(0,x.jsx)(c.A,{variant:"primary",disabled:b||k||(null===N||void 0===N?void 0:N.isLoading)||!(null!==u&&void 0!==u&&u.slot_id),onClick:async()=>{if(w(u)){const e=u.booking_id;delete u.booking_id,await C({id:e,data:u}),t(!1)}},children:(0,x.jsx)(g.A,{loading:null===N||void 0===N?void 0:N.isLoading,children:"Reschedule"})})]})]})})},N=e=>{var i,l,o,d,t,a;let{booking:h}=e;const[k,A]=(0,p.JB)(),[y,f]=(0,n.useState)({title:"",open:!1,action:""}),N=e=>{const i={id:null===h||void 0===h?void 0:h.booking_id,data:{status:e}};k(i),f((e=>({...e,open:!1})))},_=()=>{let e=null;switch(null===h||void 0===h?void 0:h.status){case"pending":e=(0,b.I4)(null===h||void 0===h?void 0:h.date)?(0,x.jsx)(c.A,{variant:"primary",className:"ms-2",size:"sm",onClick:()=>f({open:!0,title:"Reschedule Booking",children:"Are you sure want to reschedule this booking?",confirmButton:"Yes, Reschedule",onConfirm:()=>f({open:!1,action:"reschedule"})}),children:(0,x.jsx)(g.A,{loading:(null===A||void 0===A?void 0:A.isLoading)&&"reschedule"===(null===f||void 0===f?void 0:f.action),children:"Reschedule"})}):(0,x.jsx)(c.A,{variant:"primary",className:"ms-2",size:"sm",onClick:()=>f({open:!0,title:"Confirm Booking",body:"Are you sure want to confirm this booking?",confirmButton:"Yes, Confirm",onConfirm:()=>N("confirmed"),action:"confirmed"}),children:(0,x.jsx)(g.A,{loading:(null===A||void 0===A?void 0:A.isLoading)&&"confirmed"===(null===y||void 0===y?void 0:y.action),children:"Confirm"})});break;case"confirmed":const i=(0,b.I4)(null===h||void 0===h?void 0:h.date);e=(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(c.A,{variant:"primary",className:i?"ms-2 mb-2":"ms-2",size:"sm",onClick:()=>f({open:!0,title:"Reschedule Booking",confirmButton:"Yes, Reschedule",children:"Are you sure want to reschedule this booking?",onConfirm:()=>f({open:!1,action:"reschedule"})}),children:(0,x.jsx)(g.A,{loading:(null===A||void 0===A?void 0:A.isLoading)&&"reschedule"===(null===y||void 0===y?void 0:y.action),children:"Reschedule"})}),i&&(0,x.jsx)(c.A,{variant:"primary",className:"ms-2 mb-2",size:"sm",onClick:()=>f({open:!0,title:"Completed Booking",confirmButton:"Yes, Completed",children:"Are you sure want to completed this booking?",onConfirm:()=>N("completed"),action:"completed"}),children:(0,x.jsx)(g.A,{loading:(null===A||void 0===A?void 0:A.isLoading)&&"completed"===(null===y||void 0===y?void 0:y.action),children:"Completed"})})]});break;case"canceled":e=(0,x.jsx)(c.A,{variant:"primary",className:"ms-2",size:"sm",onClick:()=>f({open:!0,title:"Resume Booking",body:"Are you sure want to resume this booking?",confirmButton:"Yes, Resume",onConfirm:()=>N("pending"),action:"pending"}),children:(0,x.jsx)(g.A,{loading:(null===A||void 0===A?void 0:A.isLoading)&&"pending"===(null===y||void 0===y?void 0:y.action),children:"Resume"})});break;default:e=null}return e||(0,x.jsx)(x.Fragment,{})};return(0,x.jsxs)(s.A,{className:"mb-3",style:{width:"100%"},children:["reschedule"===(null===y||void 0===y?void 0:y.action)?(0,x.jsx)(C,{booking:h}):(0,x.jsx)(j,{...y,onClose:()=>f({open:!1}),children:null===y||void 0===y?void 0:y.children}),(0,x.jsx)(s.A.Body,{children:(0,x.jsxs)(r.A,{children:[(0,x.jsxs)(v.A,{xs:8,children:[(0,x.jsx)(s.A.Title,{className:"card-title",children:null===h||void 0===h?void 0:h.customer.display_name}),(0,x.jsxs)(s.A.Text,{className:"card-text",children:[h.date,","," ",(0,x.jsx)("span",{className:"text-capitalize",children:null===h||void 0===h||null===(i=h.slot)||void 0===i?void 0:i.day}),","," ",(0,b.fU)(null===h||void 0===h||null===(l=h.slot)||void 0===l?void 0:l.start_time)," -"," ",(0,b.fU)(null===h||void 0===h||null===(o=h.slot)||void 0===o?void 0:o.end_time)]}),(0,x.jsxs)(s.A.Text,{className:"card-text",children:[null===h||void 0===h||null===(d=h.service)||void 0===d?void 0:d.name," - (",m.T,null===h||void 0===h||null===(t=h.service)||void 0===t?void 0:t.price_amount,")",(0,x.jsx)("br",{}),"Payment: ",(0,x.jsx)(u.A,{children:null===h||void 0===h||null===(a=h.payment)||void 0===a?void 0:a.status})]})]}),(0,x.jsxs)(v.A,{xs:4,className:"text-right",children:[(0,x.jsx)(_,{}),["pending","confirmed"].includes(null===h||void 0===h?void 0:h.status)&&(0,x.jsx)(c.A,{variant:"danger",className:"ms-2",size:"sm",onClick:()=>{f({open:!0,type:"danger",title:"Cancel Booking",confirmButton:"Yes, Cancel",body:"Are you sure want to cancel this booking?",onConfirm:()=>{N("canceled")},action:"canceled"})},children:(0,x.jsx)(g.A,{loading:(null===A||void 0===A?void 0:A.isLoading)&&"canceled"===(null===y||void 0===y?void 0:y.action),children:"Cancel"})})]})]})})]})};var _=l(1685);const w=e=>{let{title:i}=e;return(0,x.jsx)(s.A,{className:"no-bookings-card",children:(0,x.jsxs)(s.A.Body,{className:"no-bookings-body",children:[(0,x.jsx)("div",{className:"no-bookings-icon",children:"\ud83d\udcc5"}),(0,x.jsxs)(s.A.Title,{className:"no-bookings-title",children:["No ",i," bookings"]}),(0,x.jsx)(s.A.Text,{className:"no-bookings-text",children:"all"===i?"You have no bookings yet. Start by creating your availability.":"You have no ".concat(i," bookings. As soon as someone books a time with you it will show up here.")})]})})},B=()=>{var e,i,l,s,c;const[r,v]=(0,n.useState)("all"),[u,m]=(0,n.useState)({all:[],upcoming:[],pending:[],completed:[],canceled:[]}),{data:h,isLoading:g,isFetching:j}=(0,p.aE)({});(0,n.useEffect)((()=>{if(h){const e=h.filter((e=>"confirmed"===(null===e||void 0===e?void 0:e.status))),i=h.filter((e=>"pending"===(null===e||void 0===e?void 0:e.status))),l=h.filter((e=>"completed"===(null===e||void 0===e?void 0:e.status))),n=h.filter((e=>"canceled"===(null===e||void 0===e?void 0:e.status)));m({all:h,upcoming:e,pending:i,completed:l,canceled:n})}}),[h]);const b=[{key:"all",label:"All",count:(null===u||void 0===u||null===(e=u.all)||void 0===e?void 0:e.length)||0,data:null===u||void 0===u?void 0:u.all},{key:"upcoming",label:"Upcoming",count:(null===u||void 0===u||null===(i=u.upcoming)||void 0===i?void 0:i.length)||0,data:null===u||void 0===u?void 0:u.upcoming},{key:"unconfirmed",label:"Unconfirmed",count:(null===u||void 0===u||null===(l=u.pending)||void 0===l?void 0:l.length)||0,data:null===u||void 0===u?void 0:u.pending},{key:"past",label:"Completed",count:(null===u||void 0===u||null===(s=u.completed)||void 0===s?void 0:s.length)||0,data:null===u||void 0===u?void 0:u.completed},{key:"canceled",label:"Canceled",count:(null===u||void 0===u||null===(c=u.canceled)||void 0===c?void 0:c.length)||0,data:null===u||void 0===u?void 0:u.canceled}];return(0,x.jsx)("div",{id:"booking",className:"bookings-container",children:(0,x.jsxs)(o.A,{fluid:!0,className:"bookings-wrapper",children:[(0,x.jsx)(a.N9,{}),(0,x.jsx)(_.A,{loading:g||j}),(0,x.jsx)("div",{className:"bookings-content",children:(0,x.jsxs)(d.A.Container,{id:"bookings-tabs",activeKey:r,onSelect:e=>v(e),children:[(0,x.jsx)("div",{className:"tabs-wrapper",children:(0,x.jsx)(t.A,{variant:"pills",className:"bookings-nav",children:b.map((e=>(0,x.jsx)(t.A.Item,{className:"nav-item-custom",children:(0,x.jsx)(t.A.Link,{eventKey:e.key,className:"nav-link-custom",children:(0,x.jsxs)("div",{className:"tab-content",children:[(0,x.jsx)("span",{className:"tab-label",children:e.label}),(0,x.jsx)("span",{className:"tab-count",children:e.count})]})})},e.key)))})}),(0,x.jsx)("div",{className:"tab-content-wrapper",children:(0,x.jsx)(d.A.Content,{children:b.map((e=>(0,x.jsx)(d.A.Pane,{eventKey:e.key,children:(0,x.jsxs)("div",{className:"bookings-section",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsxs)("h3",{className:"section-title",children:[e.label," Bookings"]}),(0,x.jsxs)("span",{className:"section-count",children:[e.count," appointments"]})]}),(0,x.jsx)("div",{className:"bookings-grid",children:e.data&&e.data.length>0?e.data.map((e=>(0,x.jsx)("div",{className:"booking-item",children:(0,x.jsx)(N,{booking:e})},e.booking_id))):(0,x.jsx)(w,{title:e.label.toLowerCase()})})]})},e.key)))})})]})})]})})}},6867:(e,i,l)=>{l.d(i,{A:()=>d});var n=l(4201),o=l(579);function d(e){return null!==e&&void 0!==e&&e.children?(0,o.jsxs)("div",{className:"d-flex flex-col justify-content-center align-items-center gap-1",children:[(0,o.jsx)(n.A,{height:25,color:"#18A0FB",...e}),(0,o.jsx)("strong",{children:null===e||void 0===e?void 0:e.children})]}):(0,o.jsx)(n.A,{height:25,color:"#18A0FB",...e})}},1089:(e,i,l)=>{l.d(i,{I4:()=>o,Qj:()=>t,fU:()=>n,pP:()=>d});const n=e=>{if(!e)return"00:00";let[i,l]=null===e||void 0===e?void 0:e.split(":");const n=i<12?"AM":"PM";return i=i%12||12,"".concat(i.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0")," ").concat(n)},o=e=>{const i=new Date,l=new Date(Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()));return(e=new Date(e)).toISOString()<l.toISOString()},d=e=>{const i=[],l=new Date(0,0,0,0,"start"===e?0:30,0),n=new Date(0,0,0,"start"===e?23:24,"start"===e?30:0,0);for(;l<=n;){const e=l.getHours()%12||12,n=l.getMinutes().toString().padStart(2,"0"),o=l.getHours()<12?"AM":"PM";i.push({value:"".concat(l.getHours(),":").concat(n),label:"".concat(e.toString().padStart(2,"0"),":").concat(n," ").concat(o)}),l.setMinutes(l.getMinutes()+30)}return i},t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const i=[];for(const t of e){var l,o,d;if(i[null===t||void 0===t||null===(l=t.day)||void 0===l?void 0:l.toLowerCase()])i[null===t||void 0===t||null===(o=t.day)||void 0===o?void 0:o.toLowerCase()].timeSlots.push({...t,start:{value:null===t||void 0===t?void 0:t.start_time,label:n(null===t||void 0===t?void 0:t.start_time)},end:{value:null===t||void 0===t?void 0:t.end_time,label:n(null===t||void 0===t?void 0:t.end_time)}});else i[null===t||void 0===t||null===(d=t.day)||void 0===d?void 0:d.toLowerCase()]={enabled:!0,day:null===t||void 0===t?void 0:t.day,timeSlots:[{...t,start:{value:null===t||void 0===t?void 0:t.start_time,label:n(null===t||void 0===t?void 0:t.start_time)},end:{value:null===t||void 0===t?void 0:t.end_time,label:n(null===t||void 0===t?void 0:t.end_time)}}]}}return i}}}]);
//# sourceMappingURL=299.d6d4d27c.chunk.js.map